#!/usr/bin/env bash

IMAGE=dkarlovi/php-toolbox
TAG=latest

# ensure Compose cache folder exists before running docker run
# this avoids having Docker creating it as root user
mkdir -p "${HOME}/.composer/cache"

tty=
tty -s && tty=--tty

env=
if [ -f .env ]; then
    env="--env-file .env"
fi

docker run --rm ${tty} --interactive \
    ${env} \
    --user "$(id -u):$(id -g)" \
    --volume "${HOME}/.composer:/composer" \
    --volume "$(pwd):/app" \
    "${IMAGE}:${TAG}" ${@}
